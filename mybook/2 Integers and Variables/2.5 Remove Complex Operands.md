# 2.5 Remove Complex Operands

![Figure 2.15 Lmon Var...](images/page_41_vector_176.png)
*Figure 2.15 Lmon Var is LVar with operands restricted to atomic expressions.*

![Figure 2.15 presents the...](images/page_41_vector_389.png)
*Figure 2.15 presents the grammar for the output of this pass, the language Lmon Var . The only difference is that operator arguments are restricted to be atomic expres- sions that are defined by the atm nonterminal. In particular, integer constants and variables are atomic. The atomic expressions are pure (they do not cause or depend on side effects) whereas complex expressions may have side effects, such as (Prim 'read ()). A language with this separation between pure expressions versus expressions with side effects is said to be in monadic normal form (Moggi 1991; Danvy 2003), which explains the mon in the name Lmon Var . An important invariant of the remove_complex_operands pass is that the relative ordering among complex expressions is not changed, but the relative ordering between atomic expressions and complex expressions can change and often does. These changes are behavior preserving because atomic expressions are pure. Another well-known form for intermediate languages is the administrative normal form (ANF) (Danvy 1991; Flanagan et al. 1993). The Lmon Var language is not quite in ANF because it allows the right-hand side of a let to be a complex expression, such as another let. The flattening of nested let expressions is instead one of the responsibilities of the explicate_control pass. We recommend implementing this pass with two mutually recursive functions, rco_atom and rco_exp. The idea is to apply rco_atom to subexpressions that need*

